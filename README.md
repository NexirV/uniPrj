not fully optimized for time constraints
